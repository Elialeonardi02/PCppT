loop 1..Цел(ввод())
   var s = ввод()
   var m = Цел(ввод())
   var b = ввод().разделить(‘ ’).применить(Цел)
   var массив = сортй(Массив(Множество(Массив(s))))
   var ответ = [Символ("\0")] * m
   loop сумма(b) != -m
      Множество[Цел] индексы
      loop(i) 0 .< m
         if b[i] == 0
            индексы.доб(i)
            b[i] = -1
      loop
         var q = массив.извлечь()
         if индексы.длина <= s.колво(q)
            loop(i) индексы
               ответ[i] = q
            loop.прервать
      loop(i) индексы
         loop(j) 0 .< m
            if b[j] != -1
               b[j] -= abs(i - j)
   вывод(ответ.соединить(‘’))